"use strict";(self["webpackChunkhugofast"]=self["webpackChunkhugofast"]||[]).push([[551],{71551:function(t,e,s){s.r(e),s.d(e,{default:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"layout"},[e("Aside"),e("div",{staticClass:"container edit"},[e("TopHeader"),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"editwrap"},[e("a-row",[e("a-col",{attrs:{span:24}},[t._v("标题："),e("a-input",{model:{value:t.result2.title,callback:function(e){t.$set(t.result2,"title",e)},expression:"result2.title"}})],1)],1),e("a-row",{attrs:{gutter:20}},[e("a-col",{attrs:{span:8}},[t._v("时间: "),e("a-input",{attrs:{placeholder:"格式如：2023-05-31"},model:{value:t.result3.date,callback:function(e){t.$set(t.result3,"date",e)},expression:"result3.date"}})],1),e("a-col",{attrs:{span:8}},[t._v("分类: "),e("a-input",{attrs:{placeholder:"暂时只支持填写一个分类"},model:{value:t.result4.category,callback:function(e){t.$set(t.result4,"category",e)},expression:"result4.category"}})],1),e("a-col",{attrs:{span:8}},[t._v("标签: "),e("a-input",{attrs:{placeholder:"暂时只支持填写一个标签"},model:{value:t.result5.tags,callback:function(e){t.$set(t.result5,"tags",e)},expression:"result5.tags"}})],1)],1),e("a-row",[e("a-col",{attrs:{span:24}},[[e("a-textarea",{staticClass:"content",attrs:{"auto-size":""},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})]],2)],1),e("a-row",[e("a-col",{attrs:{span:24}},[e("a-button",{attrs:{type:"primary"},on:{click:t.publishNews}},[t._v("发布新文章")])],1)],1)],1)],1)],1)},r=[],l=s(59708),o=s(78177),n=s(6154);let i=s(19575).Base64;var u={name:"PublishView",components:{Aside:l.Z,TopHeader:o.Z},data(){return{bloglistdir:"",loading:!1,HugoFastghpToken:"",githubrepo:"",detailsSha:"",id:"",text:"",pattern1:/slug:\s*(.*?)\n/,result1:{slug:""},pattern2:/title:\s*(.*?)\n/,result2:{ttile:""},pattern3:/date:\s*(.*?)\n/,result3:{date:""},pattern4:/categories:\s*(.*?)\n/,result4:{category:""},pattern5:/tags:\s*(.*?)\n/,result5:{tags:""},pattern:/^---\n([\s\S]+?)\n---/,content:null,currentDate:"",base64Str:""}},methods:{getDate(){const t=new Date,e=t.getFullYear(),s=t.getMonth()+1,a=t.getDate();this.currentDate=`${e}-${s}-${a}`},autogetDate(){const t=new Date,e=t.getFullYear(),s=t.getMonth()+1,a=t.getDate();this.result3.date=`${e}-${s}-${a}`},async publishNews(){const t="---\ntitle: "+this.result2.title+"\ndate: "+this.result3.date+"\ncategories:\n  - "+this.result4.category+"\ntags:\n  - "+this.result5.tags+"\n---\n\n"+this.content;return this.base64Str=i.encode(t),""==this.result2.title||void 0==this.result2.title?(this.$message.error("未填写标题"),!1):""==this.result3.date||void 0==this.result3.date?(this.$message.error("未填写日期"),!1):""==this.result4.category||void 0==this.result4.category?(this.$message.error("未填写分类"),!1):""==this.content||void 0==this.content?(this.$message.error("请输入文章内容"),!1):(this.loading=!0,void n.Z.put("https://api.github.com/repos/"+this.githubrepo+"/contents/"+this.bloglistdir+"/"+this.result3.date+"-"+this.result2.title+".md",{message:"提交于 "+this.currentDate,content:this.base64Str},{headers:{Accept:"application/vnd.github.v3+json",Authorization:"token "+this.HugoFastghpToken}}).then((t=>{this.loading=!1,this.$message.success("发布成功"),localStorage.removeItem("HugoFastallData"),this.$router.push("/list")})).catch((t=>{console.error(t),this.loading=!1})))}},computed:{},mounted(){this.HugoFastghpToken=localStorage.getItem("HugoFastghpToken"),this.githubrepo=localStorage.getItem("HugoFastRepoName"),this.bloglistdir=localStorage.getItem("bloglistdir"),this.autogetDate()}},c=u,g=s(1001),h=(0,g.Z)(c,a,r,!1,null,null,null),d=h.exports}}]);
//# sourceMappingURL=551.1172cd29.js.map