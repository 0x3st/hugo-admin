"use strict";(self["webpackChunkhugofast"]=self["webpackChunkhugofast"]||[]).push([[365],{2365:function(t,e,s){s.r(e),s.d(e,{default:function(){return p}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"layout"},[e("Aside"),e("div",{staticClass:"container setting"},[e("TopHeader"),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[e("div",{staticClass:"item"},[e("label",[t._v("域名: ")]),e("a-input",{attrs:{placeholder:"博客域名 https://"},model:{value:t.setting.domain,callback:function(e){t.$set(t.setting,"domain",e)},expression:"setting.domain"}})],1),e("div",{staticClass:"item"},[e("label",[t._v("昵称: ")]),e("a-input",{attrs:{placeholder:"仅在管理后台生效"},model:{value:t.setting.name,callback:function(e){t.$set(t.setting,"name",e)},expression:"setting.name"}})],1),e("div",{staticClass:"item"},[e("a-button",{attrs:{type:"primary"},on:{click:t.saveSetting}},[t._v("保存设置")])],1)])],1)],1)},o=[],i=s(59708),n=s(78177),g=s(6154);let h=s(19575).Base64;var l={name:"setting",components:{Aside:i.Z,TopHeader:n.Z},data(){return{loading:!1,HugoFastghpToken:"",githubrepo:"",base64Str:"",settingBlo:!1,setting:{domain:"",name:""},ConfigSha:""}},methods:{getConfigSha(){const t=localStorage.getItem("HugoFastConfigSha");t?this.ConfigSha=t:g.Z.get("https://api.github.com/repos/"+this.githubrepo+"/contents/HugoFast.config.js").then((t=>{this.ConfigSha=t.data.sha,localStorage.setItem("HugoFastConfigSha",this.ConfigSha)})).catch((t=>{}))},saveSetting(){this.loading=!0;const t=JSON.stringify(this.setting);this.base64Str=h.encode(t),0==this.settingBlo?g.Z.put("https://api.github.com/repos/"+this.githubrepo+"/contents/HugoFast.config.js",{message:"更新 HugoFast.config.js 文件",content:this.base64Str},{headers:{Accept:"application/vnd.github.v3+json",Authorization:"token "+this.HugoFastghpToken}}).then((t=>{console.log(t),this.loading=!1,this.$message.success("保存成功"),localStorage.removeItem("HugoFastConfigSha"),this.getConfigSha()})).catch((t=>{console.error(t),this.loading=!1,this.$message.error("保存失败，请稍后重新保存")})):g.Z.put("https://api.github.com/repos/"+this.githubrepo+"/contents/HugoFast.config.js",{message:"提交于 "+this.currentDate,content:this.base64Str,sha:this.ConfigSha},{headers:{Accept:"application/vnd.github.v3+json",Authorization:"token "+this.HugoFastghpToken}}).then((t=>{this.loading=!1,this.$message.success("保存成功"),localStorage.removeItem("HugoFastConfigSha"),this.getConfigSha()})).catch((t=>{console.error(t),this.loading=!1,this.$message.error("保存失败，请稍后重新保存")})),localStorage.setItem("HugoFast_Setting",JSON.stringify(this.setting))}},computed:{},mounted(){this.HugoFastghpToken=localStorage.getItem("HugoFastghpToken"),this.githubrepo=localStorage.getItem("HugoFastRepoName");const t=JSON.parse(localStorage.getItem("HugoFast_Setting"));t&&(this.settingBlo=!0,this.setting=JSON.parse(localStorage.getItem("HugoFast_Setting"))),this.getConfigSha()}},r=l,c=s(1001),u=(0,c.Z)(r,a,o,!1,null,null,null),p=u.exports}}]);
//# sourceMappingURL=365.7c466dd3.js.map