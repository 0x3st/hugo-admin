"use strict";(self["webpackChunkhugofast"]=self["webpackChunkhugofast"]||[]).push([[707],{82707:function(t,e,s){s.r(e),s.d(e,{default:function(){return g}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"layout"},[e("Aside"),e("div",{staticClass:"container edit"},[e("TopHeader"),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"editwrap"},[e("a-row",[e("a-col",{attrs:{span:24}},[e("div",{staticClass:"edit-headicon"},[this.id?e("a",{staticStyle:{color:"#000"},attrs:{href:`https://github.com/${this.githubrepo}/blob/main/content/${this.bloglistdir}/${this.id}.md`,target:"_blank"}},[e("svg",{staticClass:"icon icon-tabler icon-tabler-brand-github",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"}},[e("path",{attrs:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"}})])]):t._e(),e("a",{staticStyle:{color:"#000"},attrs:{target:"_blank",href:`${this.setting.domain}/${this.bloglistdir}/${this.result3.date}-${this.result2.title}`}},[e("svg",{staticClass:"icon icon-tabler icon-tabler-world",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"}},[e("path",{attrs:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"}}),e("path",{attrs:{d:"M3.6 9h16.8"}}),e("path",{attrs:{d:"M3.6 15h16.8"}}),e("path",{attrs:{d:"M11.5 3a17 17 0 0 0 0 18"}}),e("path",{attrs:{d:"M12.5 3a17 17 0 0 1 0 18"}})])])])])],1),e("a-row",[e("a-col",{attrs:{span:24}},[t._v("标题："),e("a-input",{model:{value:t.result2.title,callback:function(e){t.$set(t.result2,"title",e)},expression:"result2.title"}})],1)],1),e("a-row",{attrs:{gutter:20}},[e("a-col",{attrs:{span:8}},[t._v("时间: "),e("a-input",{attrs:{placeholder:"格式如：2023-05-31"},model:{value:t.result3.date,callback:function(e){t.$set(t.result3,"date",e)},expression:"result3.date"}})],1),e("a-col",{attrs:{span:8}},[t._v("分类: "),e("a-input",{attrs:{placeholder:"暂时只支持填写一个分类"},model:{value:t.result4.category,callback:function(e){t.$set(t.result4,"category",e)},expression:"result4.category"}})],1),e("a-col",{attrs:{span:8}},[t._v("标签: "),e("a-input",{attrs:{placeholder:"暂时只支持填写一个标签"},model:{value:t.result5.tags,callback:function(e){t.$set(t.result5,"tags",e)},expression:"result5.tags"}})],1)],1),e("a-row",[e("a-col",{attrs:{span:24}},[[e("a-textarea",{staticClass:"content",attrs:{"auto-size":""},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})]],2)],1),e("a-row",[e("a-col",{attrs:{span:24}},[e("a-button",{attrs:{type:"primary"},on:{click:t.publishArticle}},[t._v("更新文章")])],1)],1)],1)],1)],1)},i=[],r=s(59708),o=s(78177),n=s(6154);let l=s(19575).Base64;var h={name:"EditView",components:{Aside:r.Z,TopHeader:o.Z},data(){return{bloglistdir:"",loading:!1,HugoFastghpToken:"",githubrepo:"",detailsSha:"",id:"",text:"",pattern1:/slug:\s*(.*?)\n/,result1:{slug:""},pattern2:/title:\s*(.*?)\n/,result2:{ttile:""},pattern3:/date:\s*(.*?)\n/,result3:{date:""},pattern4:/categories:\s*(.*?)\n/,result4:{category:""},pattern5:/tags:\s*(.*?)\n/,result5:{tags:""},pattern:/^---\n([\s\S]+?)\n---/,content:null,currentDate:"",base64Str:"",setting:{domain:""}}},methods:{findMatches(){this.loading=!0,n.Z.get("https://raw.githubusercontent.com/"+this.githubrepo+"/main/"+this.bloglistdir+"/"+this.id+".md").then((t=>{this.text=t.data,this.extractMetadata()})).catch((t=>{console.error(t)}))},getDate(){const t=new Date,e=t.getFullYear(),s=t.getMonth()+1,a=t.getDate();this.currentDate=`${e}-${s}-${a}`},extractMetadata(){const t=this.text.match(this.pattern2);if(t){const e=t[1].trim();this.result2={title:e}}const e=this.text.match(this.pattern3);if(e){const t=e[1].trim();this.result3={date:t}}const s=this.text.match(this.pattern4);if(s){const t=s[1].trim();this.result4={category:t}}const a=this.text.match(this.pattern5);if(a){const t=a[1].trim();this.result5={tags:t}}const i=this.text.match(this.pattern);i&&(this.content=this.text.replace(i[0],"").trim()),this.loading=!1},async publishArticle(){this.loading=!0,this.getDate();const t="---\ntitle: "+this.result2.title+"\ndate: "+this.result3.date+"\ncategories:\n  "+this.result4.category+"\ntags:\n  "+this.result5.tags+"\n---\n\n"+this.content;this.base64Str=l.encode(t),n.Z.put("https://api.github.com/repos/"+this.githubrepo+"/contents/"+this.bloglistdir+"/"+this.id+".md",{message:"提交于 "+this.currentDate,content:this.base64Str,sha:this.detailsSha},{headers:{Accept:"application/vnd.github.v3+json",Authorization:"token "+this.HugoFastghpToken}}).then((t=>{this.loading=!1,this.$message.success("更新成功"),localStorage.removeItem("HugoFastallData"),this.$router.push("/list")})).catch((t=>{console.error(t),this.loading=!1}))}},computed:{},mounted(){this.HugoFastghpToken=localStorage.getItem("HugoFastghpToken"),this.githubrepo=localStorage.getItem("HugoFastRepoName"),this.bloglistdir=localStorage.getItem("bloglistdir"),this.setting=JSON.parse(localStorage.getItem("HugoFast_Setting")),void 0!=this.$route.query.name?this.id=this.$route.query.name:this.id=null,this.detailsSha=this.$route.query.sha,this.findMatches()}},c=h,u=s(1001),d=(0,u.Z)(c,a,i,!1,null,null,null),g=d.exports}}]);
//# sourceMappingURL=707.bb9f021b.js.map